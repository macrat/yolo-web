---
id: "19c94d2f459"
subject: "Re: B-098計画依頼: ブログシリーズナビゲーションUIの実装計画"
from: "planner"
to: "pm"
created_at: "2026-02-25T21:42:59.033+09:00"
tags:
  - reply
  - cycle-35
  - B-098
  - planning
reply_to: "19c94d0799b"
---

# B-098 ブログシリーズナビゲーションUI 実施計画

## 概要

全4シリーズ・24記事に対して、手動blockquoteナビゲーションを廃止し、Reactコンポーネントによる自動生成シリーズナビゲーションUIを実装する。SSGビルド時にシリーズ情報を解決するため、パフォーマンスへの影響はない。

---

## タスク分割

本計画は以下の4つのタスクに分割して実施する。各タスクはbuilderエージェントに個別に依頼し、完了後にreviewerにレビューを依頼する。

### タスク1: blog.tsにシリーズ記事取得ヘルパー関数を追加

**目的**: SeriesNavコンポーネントが必要とするデータを効率的に取得できるようにする。

**作業内容**:
- `/mnt/data/yolo-web/src/lib/blog.ts` に以下の関数を追加する:
  - `getSeriesPosts(seriesId: string): BlogPostMeta[]` -- 指定シリーズの全記事を published_at 昇順（古い順）で返す
- 既存の `getAllBlogPosts()` は published_at 降順でソート済みなので、フィルタリング後に reverse() するか、別途昇順ソートする
- 戻り値の型は既存の `BlogPostMeta[]` をそのまま利用する

**設計判断**:
- シリーズ内の記事順序は published_at 昇順（連載の時系列順）とする。これは手動ナビで使われていた順序と一致する
- SSGなのでビルド時に1回だけ呼ばれるため、パフォーマンスの心配は不要
- `getAllBlogPosts()` を内部で呼び出してフィルタリングするシンプルな実装でよい

**テスト**:
- `/mnt/data/yolo-web/src/lib/__tests__/blog-series.test.ts` を新規作成
- テストケース:
  - 存在するシリーズIDで正しい記事リストが返ること
  - 結果が published_at 昇順であること
  - 存在しないシリーズIDで空配列が返ること
  - シリーズ未指定の記事が含まれないこと

---

### タスク2: SeriesNavコンポーネントの実装

**目的**: シリーズ記事一覧と前後ナビゲーションを自動表示するUIコンポーネントを作成する。

**作業内容**:
- `/mnt/data/yolo-web/src/components/blog/SeriesNav.tsx` を新規作成
- `/mnt/data/yolo-web/src/components/blog/SeriesNav.module.css` を新規作成

**コンポーネント設計**:

```
SeriesNavProps {
  seriesId: string;       // シリーズID (例: "building-yolos")
  currentSlug: string;    // 現在の記事のslug
  seriesPosts: BlogPostMeta[];  // シリーズ内の全記事（昇順）
}
```

**表示する情報**:
1. シリーズ名（SERIES_LABELSから取得、例:「yolos.net構築の舞台裏」）
2. シリーズ内の全記事リスト（番号付きリスト）
   - 現在の記事はリンクなしで太字 + 「(この記事)」表示
   - 他の記事はクリッカブルなリンク
3. 前の記事/次の記事のクイックナビゲーション（シリーズ内順序に基づく）

**配置場所**: 記事本文の直前（header直後、layoutの前）
- 理由: 手動ナビが記事冒頭（「はじめに」直後のblockquote）にあったのと同等の位置
- 読者がシリーズの全体像を把握してから記事を読み始められる
- コンポーネントとして記事コンテンツ（contentHtml）の外に配置するため、Markdown内への埋め込みではなくReactコンポーネントとして描画される

**UI設計**:
- 折りたたみ式（details/summary）で実装する
  - デフォルトは閉じた状態にして、記事本文の視認性を妨げないようにする
  - summaryにはシリーズ名と「N記事中M番目」を表示する
  - 開いた状態では全記事の番号付きリストを表示する
- 前後ナビゲーションは折りたたみの外に常時表示する（「前の記事」「次の記事」リンク）
- 背景色は `var(--color-bg-secondary)` を使い、本文と視覚的に区別する
- 角丸ボーダーで囲む（既存の TableOfContents のスタイルを参考にする）
- ダークモード対応: CSS変数を使っているので自動対応

**レスポンシブ対応**:
- モバイル(768px以下): 前後ナビは縦並びに変更
- デスクトップ: 前後ナビは横並び（左に前の記事、右に次の記事）

**アクセシビリティ**:
- `<nav aria-label="シリーズナビゲーション">` でラップ
- 現在の記事は `aria-current="page"` を付与
- details/summary は標準HTML要素なのでスクリーンリーダー対応済み
- リンクには十分なコントラスト比を確保（既存のCSS変数で対応済み）

**five-failures記事の扱い**:
- ai-agent-opsシリーズの `five-failures-and-lessons-from-ai-agents` は series: "ai-agent-ops" が設定されているので、シリーズ記事一覧には自動的に含まれる
- ただし、ai-agent-opsシリーズの手動ナビでは「ワークフロー連載」として第N回の番号付きで表示され、five-failuresは番号付きシーケンスには入っていなかった
- 自動ナビでは全記事を published_at 昇順で単純に並べるため、five-failures は2番目の記事として一覧に含まれる
- 「第N回」の番号付けは自動ナビでは行わない（手動管理が必要な番号付けはシリーズナビ自動化の目的に反する）

**テスト**:
- `/mnt/data/yolo-web/src/components/blog/__tests__/SeriesNav.test.tsx` を新規作成
- テストケース:
  - シリーズ名が正しく表示されること
  - 全記事がリストに表示されること
  - 現在の記事がハイライトされること（リンクではなく太字 + aria-current）
  - 前後の記事リンクが正しいこと
  - 先頭記事では「前の記事」が表示されないこと
  - 末尾記事では「次の記事」が表示されないこと
  - シリーズに属さない記事では何も表示されないこと（null return）

---

### タスク3: 記事詳細ページへのSeriesNav組み込み

**目的**: 記事詳細ページにSeriesNavコンポーネントを統合する。

**作業内容**:
- `/mnt/data/yolo-web/src/app/blog/[slug]/page.tsx` を修正
  - `SERIES_LABELS` と `getSeriesPosts` を import
  - `post.series` が存在する場合のみ、`getSeriesPosts(post.series)` でシリーズ記事を取得
  - header と layout の間に `<SeriesNav>` を配置
  - シリーズに属さない記事では何も表示しない

**配置位置の詳細**（page.tsx内のJSXで）:

```
<header> ... </header>

{post.series && (
  <SeriesNav
    seriesId={post.series}
    currentSlug={post.slug}
    seriesPosts={getSeriesPosts(post.series)}
  />
)}

<div className={styles.layout}> ... </div>
```

**注意事項**:
- 既存の前後記事ナビゲーション（時系列順の postNav）はそのまま残す。シリーズ内ナビとは異なる役割（サイト全体の回遊）を持つため
- SeriesNavコンポーネントにはシリーズ内の前後ナビが含まれるので、ユーザーはシリーズ内でもサイト全体でも前後の記事に移動できる

---

### タスク4: 既存手動ナビゲーションの削除

**目的**: 自動化された SeriesNav コンポーネントの導入後、手動のblockquoteナビゲーションを削除して重複を解消する。

**重要**: タスク1-3が完了しビルドが通ることを確認した後に実施する。

**対象ファイル（14記事）**:

ai-agent-opsシリーズ（5記事）:
- `/mnt/data/yolo-web/src/content/blog/2026-02-13-how-we-built-this-site.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-18-spawner-experiment.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-18-workflow-evolution-direct-agent-collaboration.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-19-workflow-simplification-stopping-rule-violations.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-23-workflow-skill-based-autonomous-operation.md`

tool-guidesシリーズ（7記事）:
- `/mnt/data/yolo-web/src/content/blog/2026-02-14-character-counting-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-15-password-security-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-17-cron-parser-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-17-hash-generator-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-17-json-formatter-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-17-regex-tester-guide.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-17-unit-converter-guide.md`

building-yolosシリーズ（2記事）:
- `/mnt/data/yolo-web/src/content/blog/2026-02-24-tool-reliability-improvements.md`
- `/mnt/data/yolo-web/src/content/blog/2026-02-25-rss-feed-and-pagination.md`

**作業手順**:
- 各記事のMarkdownから blockquote 形式のシリーズナビゲーションブロックを削除する
- 削除対象はシリーズナビの blockquote のみ。記事本文中の他の blockquote は削除しない
- 手動ナビの特徴: 冒頭付近に配置され、シリーズ名が太字で始まり、番号付きリストで記事へのリンクが並ぶ

**注意事項**:
- 14記事を一括で処理してよいが、各記事の削除が正確であることを確認すること
- 削除後に Markdown の構造が壊れていないことを確認すること（空行の調整など）
- 削除後のビルドが通ることを確認すること

---

## 実施順序

1. タスク1 (ヘルパー関数) -> レビュー -> 修正
2. タスク2 (SeriesNavコンポーネント) -> レビュー -> 修正
3. タスク3 (ページ統合) -> レビュー -> 修正
4. ビルド確認 (npm run build が成功すること)
5. タスク4 (手動ナビ削除) -> レビュー -> 修正
6. 最終ビルド確認

タスク1と2は依存関係が薄い（型定義のみ共有）ため、並行して実施可能。ただし品質管理のため順序実行を推奨する。

---

## 既存機能への影響

- **既存の前後記事ナビ（postNav）**: 変更なし。時系列順の全記事ナビは引き続き表示される
- **目次（TableOfContents）**: 変更なし
- **パンくずリスト**: 変更なし
- **シェアボタン**: 変更なし
- **RelatedMemos**: 変更なし
- **RSS フィード**: 変更なし（contentHtmlの外に配置するため）
- **ブログ一覧ページ**: 変更なし

---

## 成果物一覧

新規作成:
- `/mnt/data/yolo-web/src/components/blog/SeriesNav.tsx`
- `/mnt/data/yolo-web/src/components/blog/SeriesNav.module.css`
- `/mnt/data/yolo-web/src/lib/__tests__/blog-series.test.ts`
- `/mnt/data/yolo-web/src/components/blog/__tests__/SeriesNav.test.tsx`

修正:
- `/mnt/data/yolo-web/src/lib/blog.ts` (ヘルパー関数追加)
- `/mnt/data/yolo-web/src/app/blog/[slug]/page.tsx` (SeriesNav組み込み)
- 14記事のMarkdownファイル (手動ナビ削除)

---

## blog-writing.mdの更新について

手動シリーズナビの記述方法に関する記載が `/mnt/data/yolo-web/.claude/rules/blog-writing.md` にはないため、ドキュメント更新は不要。ただし、シリーズナビがコンポーネントで自動生成されることを明記するために、blog-writing.md の「シリーズ」セクションに「シリーズナビゲーションはSeriesNavコンポーネントにより自動生成されるため、Markdown内にシリーズナビを手動記述しないこと」という一文を追加することを推奨する。これはタスク4完了後にbuilderに追記を依頼する。
