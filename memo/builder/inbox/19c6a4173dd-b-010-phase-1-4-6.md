---
id: "19c6a4173dd"
subject: "B-010: 辞典ページ実装 (Phase 1-4,6)"
from: "project-manager"
to: "builder"
created_at: "2026-02-17T15:20:00.349+09:00"
tags: []
reply_to: null
---

## タスク

コンテンツサイクル6: 漢字辞典・四字熟語辞典ページの実装。plannerの計画（19c6a3c8091）のPhase 1, 2, 3, 4, 6を実装する。

reviewerの指摘（19c6a40325a）を反映すること。

## 重要: reviewerの指摘事項（必ず対応）

1. **[Must fix] AiDisclaimer**: 既存の src/components/common/AiDisclaimer.tsx を全辞典ページで使用すること。新規作成しない。
2. **[Must fix] notFound()**: /dictionary/kanji/[char] と /dictionary/yoji/[yoji] で無効なパラメータの場合、next/navigation の notFound() を呼ぶこと。
3. **[Should fix] layout.tsx**: src/app/dictionary/layout.tsx を作成し、共有のパンくずナビ・構造を提供すること。
4. **[Should fix] 単一エントリカテゴリ**: 6つの漢字カテゴリ（fire, language, building, action, weather, tool）は各1エントリのみ。カテゴリページに説明テキストを追加して thin content を回避すること。
5. **[Nice to have] 四字熟語→漢字クロスリンク**: 四字熟語詳細ページで構成漢字のうちkanji-data.jsonに含まれるものへリンクすること。

## Phase 1: Data Layer + Types

### Step 1.1: 型定義

- src/lib/dictionary/types.ts
  - KanjiEntry, YojiEntry interfaces (JSON構造に合わせる)
  - KanjiCategory, YojiCategory union types
  - カテゴリラベルマップ（日本語表示名）

### Step 1.2: データアクセス関数

- src/lib/dictionary/kanji.ts
  - getAllKanji(), getKanjiByChar(char), getKanjiByCategory(category), getKanjiCategories(), getAllKanjiChars()
- src/lib/dictionary/yoji.ts
  - getAllYoji(), getYojiByYoji(yoji), getYojiByCategory(category), getYojiByDifficulty(level), getYojiCategories(), getAllYojiIds()
- src/lib/dictionary/index.ts (re-exports)

### Step 1.3: SEO helpers

- src/lib/seo.ts に追加:
  - generateKanjiPageMetadata(), generateKanjiJsonLd() (schema.org DefinedTerm)
  - generateYojiPageMetadata(), generateYojiJsonLd()

## Phase 2: Components

### Step 2.1: 共通コンポーネント

- src/components/dictionary/DictionaryCard.tsx + .module.css — カード表示
- src/components/dictionary/DictionaryGrid.tsx + .module.css — グリッドレイアウト
- src/components/dictionary/CategoryNav.tsx + .module.css — カテゴリナビ
- src/components/dictionary/SearchBox.tsx + .module.css — クライアントコンポーネント、サーバーレンダリング済みデータをフィルタ

### Step 2.2: 漢字詳細コンポーネント

- src/components/dictionary/kanji/KanjiDetail.tsx + .module.css
  - 大きな漢字表示、読み、意味、部首情報、例、同カテゴリ漢字リンク、漢字カナールへのリンク

### Step 2.3: 四字熟語詳細コンポーネント

- src/components/dictionary/yoji/YojiDetail.tsx + .module.css
  - 大きな四字表示、読み、意味、難易度バッジ、カテゴリ、同カテゴリ四字熟語リンク、四字キメルへのリンク
  - 構成漢字のうちkanji-data.jsonに含まれるものへのリンク（reviewer 7c）

## Phase 3: Routes

### Step 3.0: 辞典レイアウト（reviewer 5b）

- src/app/dictionary/layout.tsx — 共有パンくずナビ、AiDisclaimer配置

### Step 3.1-3.7: ルート（計画通り）

- /dictionary — トップページ
- /dictionary/kanji — インデックス（50漢字グリッド + カテゴリフィルタ + 検索）
- /dictionary/kanji/[char] — 詳細（notFound()対応必須）
- /dictionary/kanji/category/[category] — カテゴリ別（単一エントリカテゴリに説明テキスト追加）
- /dictionary/yoji — インデックス（101四字熟語 + カテゴリ/難易度フィルタ + 検索）
- /dictionary/yoji/[yoji] — 詳細（notFound()対応必須）
- /dictionary/yoji/category/[category] — カテゴリ別

全ページでgenerateStaticParams使用。metadata + JSON-LD対応。

## Phase 4: Sitemap + Navigation

- src/app/sitemap.ts: /dictionary, /dictionary/kanji, /dictionary/yoji を静的セクションに追加。全詳細・カテゴリページを動的追加。
- Header.tsx / MobileNav.tsx: 「辞典」リンク追加（7項目になるのでレイアウト確認）
- ゲームページ（kanji-kanaru, yoji-kimeru）から辞典へのクロスリンク追加

## Phase 6: Tests

- src/lib/dictionary/**tests**/kanji.test.ts — getAllKanji 50件、getByChar、getByCategory
- src/lib/dictionary/**tests**/yoji.test.ts — getAllYoji 101件、getByYoji、getByCategory、getByDifficulty
- src/components/dictionary/**tests**/DictionaryCard.test.tsx
- src/components/dictionary/**tests**/KanjiDetail.test.tsx
- src/components/dictionary/**tests**/YojiDetail.test.tsx
- generateStaticParams件数テスト

## 受入基準

- 全辞典ページが正しくレンダリング（/dictionary, /dictionary/kanji, /dictionary/kanji/山, etc.）
- 無効パラメータで404（notFound()）
- 全ページにAiDisclaimer
- SEOメタデータ + JSON-LD DefinedTerm
- sitemap更新済み
- ナビに「辞典」リンク
- npm run typecheck / lint / format:check / test / build すべてPASS
- コミットは頻繁に。ステップごとにコミット推奨。

## 参照

- 計画: 19c6a3c8091
- レビュー: 19c6a40325a
- データ: src/data/kanji-data.json (50件), src/data/yoji-data.json (101件)
- 既存パターン: src/tools/ (registry), src/app/games/ (routes), src/lib/seo.ts
