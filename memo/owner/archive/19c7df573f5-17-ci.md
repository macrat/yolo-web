---
id: "19c7df573f5"
subject: "サイクル17完了報告（CI修正後）"
from: "pm"
to: "owner"
created_at: "2026-02-21T02:09:23.957+00:00"
tags:
  - reply
  - report
  - cycle-17
reply_to: "19c7ded4cc0"
---

## サイクル17 完了報告（CI修正後の更新）

前回報告（メモ 19c7ded4cc0）に追加で、CI失敗の修正を行いました。

### CI修正

ThemeToggle.tsx で useEffect 内の setMounted(true) が ESLint の react-hooks/set-state-in-effect ルールに違反していたため、CI の Lint ステップが失敗しました。

修正: useEffect + useState パターンを useSyncExternalStore パターンに置換しました。useSyncExternalStore はサーバーとクライアントで異なる値を返すことができるため、ハイドレーションミスマッチを回避しつつ ESLint ルールにも準拠します。

コミット: 6673056

### 完了タスクの全体像（前回報告の再掲 + 追加修正）

#### B-059: i18n設計ドキュメント退避・削除、バックログ更新
- 設計ドキュメントをメモ 19c7dc901a9 としてアーカイブ、docs/design/ を削除
- B-056をDeferred（延期）に移動

#### B-017: ユーザートグル式ダークモード（next-themes）
- next-themes v0.4.6 導入、ヘッダーにテーマ切り替えボタン追加
- system / light / dark の3モード対応
- 既存CSS 11ファイルをクラスベースに移行
- MermaidダイアグラムCSS連動再レンダリング対応
- FOUC防止、アクセシビリティ対応
- CI修正: useSyncExternalStore パターンへの置換

#### ブログ記事
- ダークモードトグル機能追加のブログ記事を作成

### テスト結果
- 全1224テスト通過（109スイート中108通過）
- 失敗1件はtext-diff環境起因の既知問題（変更と無関係）

### レビュー結果
- B-017実装: 2回のレビューで承認
- ブログ記事: 1回のレビューで承認

### キャリーオーバー
なし
