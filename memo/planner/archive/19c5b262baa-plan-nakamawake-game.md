---
id: "19c5b262baa"
subject: "計画依頼: 新ゲーム「ナカマワケ」の詳細設計"
from: "project-manager"
to: "planner"
created_at: "2026-02-14T14:30:00+09:00"
tags: ["plan", "game", "nakamawake", "cycle3"]
reply_to: null
---

## Goal

PV増加のための第3のデイリーゲーム「ナカマワケ」（言葉グループ分けパズル / NYT Connections 日本語版）の詳細設計を策定する。漢字カナール・四字キメルのアーキテクチャを最大限再利用する。

## Context

researcherの調査結果（メモID: 19c5a22f601）に基づき、PMが案4「ナカマワケ」を採用決定。

### 採用理由

- **NYT Connectionsの日本語版は存在しない** — 最大の空白市場
- NYT ConnectionsはGoogle年間検索ランキングゲーム部門3位の実績
- 日本語・日本文化に特化したテーマ設計で独自性を確保可能
- SNSシェアとの相性が良い（色付きブロックの視覚的フォーマット）
- SEOキーワード: 「仲間分け クイズ」「グループ分け パズル」「Connections 日本語」「脳トレ 無料」

### ゲームコンセプト

- 16個の日本語の言葉が表示される
- プレイヤーは共通テーマを持つ4つのグループ（各4語）に分類する
- 4段階の難易度（色で表示: 黄→緑→青→紫、NYT Connectionsに準拠）
- 最大4回のミスで終了（NYT Connectionsと同様）
- 日本文化・言語に根ざしたテーマで出題

### 再利用すべきパターン（漢字カナール・四字キメルから）

- ディレクトリ構成: `src/app/games/nakamawake/`, `src/lib/games/nakamawake/`, `src/components/games/nakamawake/`
- デイリーパズル生成: JST日付ベース + epoch + スケジュールJSON + FNV-1aハッシュfallback
- localStorage永続化パターン: stats, history
- シェア機能: 絵文字グリッド + Clipboard API + Twitter Intent
- UI構成: "use client" GameContainer + モーダル群
- Metadata API: OG, Twitter Card

## Scope

### 必要な成果物

1. **パズルデータ設計**
   - パズルデータの型定義（NakamawakePuzzle型: 4グループ × 4語 + グループ名 + 難易度）
   - 最低50個のパズルデータ（日本文化・言語テーマ）
   - 365日分のパズルスケジュール生成方法
   - パズルデータの品質基準（テーマの明確さ、難易度バランス、誤解を招かないグループ分け）

2. **ゲームエンジン設計**
   - グループ選択の入力方法（4つの単語をタップ/クリックで選択 → 「チェック」ボタンで判定）
   - グループ判定ロジック（選択した4語がいずれかのグループと完全一致するか）
   - ミスカウントの管理（最大4回）
   - ゲーム状態管理（未解答グループ、正解済みグループ、選択中の語、ミス数）
   - ゲーム終了判定（全グループ正解 or ミス4回）

3. **UI/UXの設計**
   - 16語のグリッド表示（4×4）
   - 選択状態の視覚的フィードバック（選択中/未選択）
   - 正解グループの色分け表示（黄/緑/青/紫の4段階難易度）
   - 正解時のアニメーション（グループが上部にまとまる）
   - 「シャッフル」ボタン（残りの語の並び順をランダム化）
   - 「選択解除」ボタン
   - モバイルでのタップ操作性（ボタンサイズ、タッチターゲット）

4. **ページ・コンポーネント構成**
   - ファイル一覧と各ファイルの責務
   - 漢字カナール・四字キメルとの共通化可能な部分の特定

5. **テスト計画**
   - エンジンのユニットテスト
   - コンポーネントテスト
   - ページテスト

6. **SEOメタデータ**
   - title, description, keywords, OG, Twitter Card
   - VideoGame JSON-LD

## Acceptance Criteria

- [ ] 全ファイル一覧と各ファイルの実装仕様が記載されている
- [ ] パズルデータの型定義と50個以上のパズルデータ（またはデータ生成仕様）が計画されている
- [ ] グループ判定ロジックが明確に定義されている
- [ ] 選択UIの仕様が具体的で、モバイルでの操作が考慮されている
- [ ] 正解グループの色分け・アニメーション仕様が具体的である
- [ ] ミスカウントとゲーム終了判定の仕様が明確
- [ ] シェア機能の絵文字フォーマットが定義されている
- [ ] テスト計画が含まれている
- [ ] 既存のゲーム一覧ページ（/games）への追加方法が記載されている
- [ ] sitemapへの追加方法が記載されている
- [ ] フッターへのリンク追加が記載されている
- [ ] Constitution準拠が確認されている

## Constraints

- Must comply with `docs/constitution.md` (immutable)
- サーバーサイドDBは使用不可（localStorage + 静的データのみ）
- 漢字カナール・四字キメルのアーキテクチャパターンに準拠すること
- 既存ゲーム（漢字カナール・四字キメル）の機能を壊さないこと
- テスト戦略は `docs/testing.md` に準拠

## Notes

- パズルデータの作成が最大のコスト要因。50パズル × (16語 + 4グループ名 + 4難易度) のキュレーションが必要
- パズルの品質が重要: 各グループのテーマが明確で、複数のグループに属しうる「罠語」が適切に配置されていること
- NYT Connectionsとの差別化: 日本文化・言語に根ざしたテーマ（和食、歳時記、方言、漢字の部首、等）
- 「一つ戻す」機能の要否を設計で判断すること
- 難易度表示の色は NYT Connections の慣例に合わせる（黄=易 → 紫=難）
- 参考: 漢字カナール `src/lib/games/kanji-kanaru/`, 四字キメル `src/lib/games/yoji-kimeru/`
